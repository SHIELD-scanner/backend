from typing import List, Optional

from fastapi import APIRouter, Query

from app.core.vulnerabilityClient import VulnerabilityClient as db
from app.models.vulnerability import Vulnerability

router = APIRouter()


@router.get("/", response_model=List[Vulnerability])
def list_vulnerabilities(
    namespace: Optional[str] = Query(None),
    cluster: Optional[str] = Query(None),
    severity: Optional[str] = Query(None),
):
    """List all vulnerabilities in the cluster."""
    return db().get_all(namespace=namespace, cluster=cluster, severity=severity)


@router.get("/{hash}", response_model=Vulnerability)
def show_vulnerability(hash: str):
    """Show a specific vulnerability by hash."""
    return db().get_by_hash(hash)
